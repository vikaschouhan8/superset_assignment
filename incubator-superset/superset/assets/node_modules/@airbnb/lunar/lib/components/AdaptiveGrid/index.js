"use strict";

exports.__esModule = true;
exports.default = void 0;

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _withStyles = _interopRequireDefault(require("../../composers/withStyles"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

class AdaptiveGrid extends _react.default.PureComponent {
  render() {
    const {
      breakpoints,
      children,
      cx,
      defaultItemsPerRow,
      noGutter,
      styles
    } = this.props;

    const childElements = children && _react.default.Children.map(children, (child, idx) => child ? // These items are generic and don't have a guaranteed id or any unique property
    // eslint-disable-next-line react/no-array-index-key
    _react.default.createElement("div", {
      key: idx
    }, child) : null);

    const breakpointStyles = {};
    const breakpointKeys = Object.keys(breakpoints);
    const smallestBreakpoint = breakpointKeys.reduce((min, key) => Math.min(min, parseInt(key, 10)), 10000);
    breakpointKeys.forEach(breakpoint => {
      breakpointStyles["@media (min-width: " + breakpoint + "px)"] = {
        gridTemplateColumns: "repeat(" + breakpoints[breakpoint] + ", 1fr)"
      };
    });
    breakpointStyles[breakpointKeys.length > 0 ? "@media (max-width: " + smallestBreakpoint + "px)" : '@media (min-width: 0px)'] = {
      gridTemplateColumns: "repeat(" + defaultItemsPerRow + ", 1fr)"
    };
    return _react.default.createElement("div", {
      className: cx(styles.container, noGutter && styles.container_noGutter, breakpointStyles)
    }, childElements);
  }

}

_defineProperty(AdaptiveGrid, "propTypes", {
  children: _propTypes.default.node,
  breakpoints: _propTypes.default.objectOf(_propTypes.default.number),
  defaultItemsPerRow: _propTypes.default.number,
  noGutter: _propTypes.default.bool
});

_defineProperty(AdaptiveGrid, "defaultProps", {
  breakpoints: {},
  defaultItemsPerRow: 1,
  noGutter: false
});

var _default = (0, _withStyles.default)((_ref) => {
  let {
    unit
  } = _ref;
  return {
    container: {
      display: 'grid',
      gridGap: 2 * unit
    },
    container_noGutter: {
      gridGap: 0
    }
  };
})(AdaptiveGrid);

exports.default = _default;