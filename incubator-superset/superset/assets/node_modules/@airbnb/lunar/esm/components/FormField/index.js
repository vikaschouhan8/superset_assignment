import _pt from "prop-types";

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

import React from 'react';
import withStyles from '../../composers/withStyles';
import T from '../Translate';
import Text from '../Text';
import StatusText from '../StatusText';
import FormErrorMessage from '../FormErrorMessage';
import partitionFieldProps from './partitionFieldProps';
import Prefix from './Prefix';
import Suffix from './Suffix';
export { partitionFieldProps, Prefix, Suffix };
/** A abstract form field wrapper that handles labels, affixes, errors, states, and more. */

export class FormField extends React.Component {
  render() {
    const {
      cx,
      children,
      compact,
      compactSpacing,
      disabled,
      errorMessage,
      hideLabel,
      hideOptionalLabel,
      id,
      inline,
      invalid,
      label,
      labelDescription,
      noSpacing,
      optional,
      renderBeforeLabel,
      renderFullWidth,
      renderLargeLabel,
      stretchLabel,
      styles,
      prefix,
      suffix,
      topAlign
    } = this.props;
    const content = React.createElement("div", {
      className: cx(styles.input, inline && renderBeforeLabel && styles.input_beforeInline, inline && !renderBeforeLabel && styles.input_afterInline, hideLabel && styles.input_hideLabel, renderFullWidth && styles.input_fullWidth)
    }, prefix && React.createElement("div", {
      className: cx(styles.affix)
    }, prefix), React.createElement("div", {
      className: cx(styles.anchor)
    }, children), suffix && React.createElement("div", {
      className: cx(styles.affix)
    }, suffix));
    return React.createElement("section", {
      className: cx(styles.field, (compact || compactSpacing) && !noSpacing && styles.field_compactSpacing, noSpacing && styles.field_noSpacing)
    }, React.createElement("div", {
      className: cx(inline && styles.content_inline, topAlign && styles.content_topAlign)
    }, renderBeforeLabel && content, React.createElement("label", {
      htmlFor: id,
      className: cx(styles.label, stretchLabel && styles.label_stretch, hideLabel && styles.label_hidden, (inline || renderBeforeLabel) && styles.label_noSpacing)
    }, React.createElement(StatusText, {
      danger: invalid,
      muted: disabled,
      small: compact,
      bold: !renderLargeLabel
    }, label, optional && !hideOptionalLabel && React.createElement("span", {
      className: cx(styles.optional)
    }, React.createElement(Text, {
      inline: true,
      small: true,
      muted: true
    }, React.createElement(T, {
      k: "lunar.form.optional",
      phrase: "(optional)",
      context: "A form field is marked as optional"
    })))), labelDescription && React.createElement(Text, {
      small: true
    }, labelDescription)), !renderBeforeLabel && content), invalid && React.createElement(FormErrorMessage, {
      id: id,
      error: errorMessage
    }));
  }

}

_defineProperty(FormField, "propTypes", {
  compact: _pt.bool,
  compactSpacing: _pt.bool,
  disabled: _pt.bool,
  errorMessage: _pt.string,
  field: _pt.any,
  hideLabel: _pt.bool,
  hideOptionalLabel: _pt.bool,
  inline: _pt.bool,
  invalid: _pt.bool,
  label: _pt.any.isRequired,
  labelDescription: _pt.node,
  noSpacing: _pt.bool,
  optional: _pt.bool,
  prefix: _pt.node,
  suffix: _pt.node,
  children: _pt.any.isRequired,
  id: _pt.string.isRequired,
  renderBeforeLabel: _pt.bool,
  renderFullWidth: _pt.bool,
  renderLargeLabel: _pt.bool,
  stretchLabel: _pt.bool,
  topAlign: _pt.bool
});

_defineProperty(FormField, "defaultProps", {
  compact: false,
  compactSpacing: false,
  disabled: false,
  errorMessage: '',
  hideLabel: false,
  hideOptionalLabel: false,
  inline: false,
  invalid: false,
  labelDescription: null,
  noSpacing: false,
  optional: false,
  prefix: null,
  renderBeforeLabel: false,
  renderFullWidth: false,
  renderLargeLabel: false,
  stretchLabel: false,
  suffix: null,
  topAlign: false
});

export default withStyles((_ref) => {
  let {
    unit
  } = _ref;
  return {
    field: {
      marginBottom: unit * 3,
      '@selectors': {
        ':last-child, :only-child': {
          marginBottom: 0
        }
      }
    },
    field_compactSpacing: {
      marginBottom: unit * 2
    },
    field_noSpacing: {
      margin: 0
    },
    content_inline: {
      display: 'flex',
      alignItems: 'center'
    },
    content_topAlign: {
      alignItems: 'flext-start'
    },
    label: {
      margin: 0,
      marginBottom: unit,
      display: 'block',
      flexGrow: 0
    },
    label_stretch: {
      flexBasis: '100%'
    },
    label_hidden: {
      display: 'none'
    },
    label_noSpacing: {
      margin: 0
    },
    optional: {
      marginLeft: unit,
      display: 'inline-block'
    },
    input: {
      display: 'flex',
      position: 'relative',
      flexGrow: 1
    },
    input_fullWidth: {
      width: '100%'
    },
    input_beforeInline: {
      marginRight: unit
    },
    input_afterInline: {
      marginLeft: unit
    },
    input_hideLabel: {
      margin: 0
    },
    affix: {
      flexGrow: 0
    },
    anchor: {
      flexGrow: 1
    }
  };
})(FormField);