"use strict";

exports.__esModule = true;
exports.default = exports.PreviewBar = void 0;

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _interweaveEmoji = require("interweave-emoji");

var _withContext = _interopRequireDefault(require("./withContext"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var TITLE_REGEX = /(^|:|\.)\s?[a-z]/g;

var PreviewBar = function (_React$PureComponent) {
  _inheritsLoose(PreviewBar, _React$PureComponent);

  function PreviewBar() {
    return _React$PureComponent.apply(this, arguments) || this;
  }

  var _proto = PreviewBar.prototype;

  _proto.formatTitle = function formatTitle(title) {
    return title.replace(TITLE_REGEX, function (token) {
      return token.toUpperCase();
    });
  };

  _proto.render = function render() {
    var _this$props = this.props,
        _this$props$context = _this$props.context,
        classNames = _this$props$context.classNames,
        messages = _this$props$context.messages,
        emoji = _this$props.emoji,
        emojiLargeSize = _this$props.emojiLargeSize,
        emojiPath = _this$props.emojiPath,
        emojiSource = _this$props.emojiSource,
        hideEmoticon = _this$props.hideEmoticon,
        hideShortcodes = _this$props.hideShortcodes,
        noPreview = _this$props.noPreview;

    if (!emoji) {
      var preview = noPreview || messages.noPreview;
      return _react.default.createElement("div", {
        className: classNames.preview
      }, preview && _react.default.createElement("div", {
        className: classNames.noPreview
      }, preview));
    }

    var title = emoji.annotation || emoji.name;
    var subtitle = [];

    if (!hideEmoticon && emoji.emoticon) {
      subtitle.push(emoji.emoticon);
    }

    if (!hideShortcodes && emoji.canonical_shortcodes) {
      subtitle.push.apply(subtitle, emoji.canonical_shortcodes);
    }

    return _react.default.createElement("div", {
      className: classNames.preview
    }, _react.default.createElement("div", {
      className: classNames.previewEmoji
    }, _react.default.createElement(_interweaveEmoji.Emoji, {
      emojiLargeSize: emojiLargeSize,
      emojiPath: emojiPath,
      emojiSource: emojiSource,
      enlargeEmoji: true,
      hexcode: emoji.hexcode
    })), _react.default.createElement("div", {
      className: classNames.previewContent
    }, title && _react.default.createElement("div", {
      className: classNames.previewTitle
    }, this.formatTitle(title)), subtitle.length > 0 && _react.default.createElement("div", {
      className: classNames.previewSubtitle
    }, subtitle.join(' '))));
  };

  return PreviewBar;
}(_react.default.PureComponent);

exports.PreviewBar = PreviewBar;

_defineProperty(PreviewBar, "propTypes", {
  emoji: _propTypes.default.oneOfType([_propTypes.default.any, _propTypes.default.oneOf([null])]),
  emojiLargeSize: _propTypes.default.any.isRequired,
  emojiPath: _propTypes.default.any.isRequired,
  emojiSource: _propTypes.default.any.isRequired,
  hideEmoticon: _propTypes.default.bool.isRequired,
  hideShortcodes: _propTypes.default.bool.isRequired,
  noPreview: _propTypes.default.node
});

_defineProperty(PreviewBar, "defaultProps", {
  emoji: null,
  noPreview: null
});

var _default = (0, _withContext.default)(PreviewBar);

exports.default = _default;