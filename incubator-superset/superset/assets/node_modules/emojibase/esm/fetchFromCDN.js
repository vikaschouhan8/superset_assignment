import _objectSpread from "@babel/runtime/helpers/esm/objectSpread";
import _objectWithoutProperties from "@babel/runtime/helpers/esm/objectWithoutProperties";
export default function fetchFromCDN(path) {
  var version = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'latest';
  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

  if ("production" !== process.env.NODE_ENV) {
    if (!path || path.slice(-5) !== '.json') {
      throw new Error('A valid JSON dataset is required to fetch.');
    }

    if (!version) {
      throw new Error('A valid release version is required.');
    }
  }

  var _options$local = options.local,
      local = _options$local === void 0 ? false : _options$local,
      opts = _objectWithoutProperties(options, ["local"]);

  var storage = local ? localStorage : sessionStorage;
  var cacheKey = "emojibase/".concat(version, "/").concat(path);
  var cachedData = storage.getItem(cacheKey);

  if (cachedData) {
    try {
      return Promise.resolve(JSON.parse(cachedData));
    } catch (error) {
      return Promise.resolve([]);
    }
  }

  return fetch("https://cdn.jsdelivr.net/npm/emojibase-data@".concat(version, "/").concat(path), _objectSpread({
    credentials: 'omit',
    mode: 'cors',
    redirect: 'error'
  }, opts)).then(function (response) {
    if (!response.ok) {
      throw new Error('Failed to load Emojibase dataset.');
    }

    return response.json();
  }).then(function (data) {
    try {
      storage.setItem(cacheKey, JSON.stringify(data));
    } catch (error) {}

    return data;
  });
}